"use strict";var images=[],$body=$("body"),$window=$(window),wh=$window.height(),ww=$window.width(),vh=wh-50,prevURL=null,nextURL=null,$nextprev=$("span.nextprev"),$title=$("title"),title=$title.text(),boxSize=250,boxSizeD=ww/boxSize,boxSizeI=parseInt(ww/boxSize,10),defOpacity=.75,overlayOpacity=.9,fontSize=14;boxSizeD>boxSizeI&&(boxSize+=(ww-boxSize*boxSizeI)/boxSizeI),title.indexOf("newest submissions : ")>-1&&(title=title.substr(21)),$("a",$nextprev).each(function(){var e=$(this);e.text().indexOf("prev")>-1?prevURL=e.attr("href"):e.text().indexOf("next")>-1&&(nextURL=e.attr("href"))}),$("a.title").each(function(){var e=$(this),t=e.attr("href"),i=e.text();if(i.indexOf("r/")>-1){for(var a="",n="",o="",r=i.indexOf("r/"),d=-1,s=-1,l=r;l>-1;l--)if(" "==i.substr(l,1)){d=l;break}d>-1&&(a=i.substr(0,d));for(var l=r;l<i.length;l++)if(" "==i.substr(l,1)){s=l;break}s>-1&&(o=i.substr(s)),d>-1&&(n=-1==s?i.substr(d+1):i.substr(d+1,s-d)),n.length>0&&"/"!=n.substr(0,1)&&(n="/"+n),""!=n&&(i=a+' <a href="'+n+'" style="display: inline; height: auto;" target="_blank">'+n+"</a> "+o)}if(-1!=t.indexOf("imgur.com")&&!(t.indexOf("imgur.com/a/")>-1||t.indexOf("imgur.com/gallery/")>-1||t.indexOf(".gifv")>-1)){"?"==t.substr(t.length-1)&&(t=t.substr(0,t.length-1)),-1==t.indexOf(".jpg")&&-1==t.indexOf(".jpeg")&&-1==t.indexOf(".gif")&&-1==t.indexOf(".png")&&(t+=".png");var p=e.parent().parent(),f=$("ul.buttons",p),h=$("li.nsfw-stamp",f),g=$("p.tagline",p),c=$("span.unvoted",g),x=$("a.author",p),b=!1,m=null,u=0,v=parseInt(c.text().substr(0,c.text().indexOf(" ")),10),y=x.text();h.length>0&&(b=!0),$("li",f).each(function(){var e=$("a.comments",$(this));e.length>0&&(m=e.attr("href"),"comment"!=e.text()&&(u=parseInt(e.text().substr(0,e.text().indexOf(" ")),10)))}),images.push({imageURL:t,commentsURL:m,title:i,comments:u,isNSFW:b,points:v,author:y})}});var $prev=$("<a>").attr("href",prevURL).css({display:"inline-block",fontSize:fontSize,paddingRight:10}).text("Prev"),$next=$("<a>").attr("href",nextURL).css({display:"inline-block",fontSize:fontSize,paddingRight:30}).text("Next"),$imageCount=$("<span>").css({display:"inline-block",fontSize:fontSize,paddingRight:30}).text("Displaying "+images.length+" images"),$titleText=$("<span>").css({fontSize:fontSize}).html('Reddit Gallery of <a href="'+window.location.href+'">'+title+"</a>");$left=$("<div>").css({"float":"left",paddingLeft:16,paddingTop:16}).append($prev).append($next).append($imageCount).append($titleText);var $close=$("<a>").attr("href",window.location.href).css({fontSize:fontSize}).text("Close"),$right=$("<div>").css({"float":"right",paddingRight:16,paddingTop:16}).append($close),$header=$("<div>").css({backgroundColor:"#fff",height:50,left:0,overflow:"hidden",position:"fixed",right:0,top:0,zIndex:99}).append($left).append($right),$gallery=$("<div>").css({marginTop:50,paddingBottom:50,width:"100%"});images.forEach(function(e){var t=$("<header>").css({backgroundColor:"#fff",color:"#000",fontSize:fontSize,padding:10,textAlign:"center",opacity:overlayOpacity}).html(e.title),i=$("<a>").addClass("blanket").attr("href",e.imageURL).attr("target","_blank").css({display:"block",height:boxSize,width:"100%"}),a=$("<a>").attr("href",e.commentsURL).attr("target","_blank").css({display:"block","float":"left",fontSize:10,paddingLeft:10}).text(e.points+" point"+(1==e.points?"":"s")+", "+e.comments+" comment"+(1==e.comments?"":"s")),n=$("<a>").attr("href","/u/"+e.author).attr("target","_blank").css({display:"block","float":"right",fontSize:10,paddingRight:10}).text(e.author),o=$("<footer>").css({backgroundColor:"#fff",color:"#000",height:22,opacity:overlayOpacity,overflow:"hidden",paddingTop:8}).append(a).append(n);$box=$("<div>").addClass("galleryBox").css({backgroundImage:"url("+e.imageURL+")",backgroundPosition:"center",backgroundSize:"cover","float":"left",height:boxSize,opacity:defOpacity,overflow:"hidden",width:boxSize}).mouseenter(function(){var e=$(this),t=$("header",e),i=$("a.blanket",e),a=($("footer",e),t.height()+20),n=150;e.animate({opacity:1},n),t.animate({marginTop:0},n),i.animate({height:boxSize-(30+a)},n)}).mouseleave(function(){var e=$(this),t=$("header",e),i=$("a.blanket",e),a=($("footer",e),t.height()+20),n=100;e.animate({opacity:defOpacity},n),t.animate({marginTop:0-a},n),i.animate({height:boxSize},n)}).append(t).append(i).append(o),$gallery.append($box)});var $wrapper=$("<div>").addClass("redditGallery").css({width:"100%"}).append($header).append($gallery);null==prevURL&&$prev.hide(),null==nextURL&&$next.hide(),$body.children().remove(),$body.append($wrapper),$body.css({backgroundColor:"#000"}),$("div.galleryBox").each(function(){var e=$(this),t=$("header",e),i=t.height()+20;t.css({marginTop:0-i})});
